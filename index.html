<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>OneChat</title>
  <style>
    body { background: #111; color: white; font-family: Arial; text-align: center; }
    #chat { width: 80%; margin: 20px auto; background: #222; padding: 10px; height: 300px; overflow-y: auto; border-radius: 10px; }
    #controls { margin-top: 10px; }
    input { width: 70%; padding: 10px; }
    button { padding: 10px 20px; margin: 5px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>OneChat ðŸ”—</h1>
  <div id="chat">Click "Start" to find a stranger...</div>
  
  <div id="controls">
    <input id="msgInput" type="text" placeholder="Type a message"/>
    <button id="sendBtn">Send</button>
    <button id="skipBtn">Skip</button>
    <button id="startBtn">Start</button>
  </div>

  <script src="/socket.io/socket.io.js"></script>
  <script>
    const socket = io();
    const chat = document.getElementById("chat");
    const input = document.getElementById("msgInput");
    const sendBtn = document.getElementById("sendBtn");
    const skipBtn = document.getElementById("skipBtn");
    const startBtn = document.getElementById("startBtn");

    function addMessage(msg) {
      const div = document.createElement("div");
      div.textContent = msg;
      chat.appendChild(div);
      chat.scrollTop = chat.scrollHeight;
    }

    // Handle incoming messages
    socket.on("message", msg => addMessage("Stranger: " + msg));
    socket.on("system", msg => addMessage("[System] " + msg));

    // Send message
    sendBtn.onclick = () => {
      if (input.value.trim()) {
        socket.emit("message", input.value);
        addMessage("You: " + input.value);
        input.value = "";
      }
    };

    // Skip to next stranger
    skipBtn.onclick = () => {
      socket.emit("skip");
      addMessage("[You skipped the chat]");
    };

    // Start chat
    startBtn.onclick = () => {
      socket.emit("start");
      addMessage("[Searching for a stranger...]");
    };
  </script>
</body>
</html>